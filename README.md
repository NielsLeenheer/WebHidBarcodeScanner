# webhid-barcode-scanner

This is an library that allows you to use a HoneyWell Voyager 1400g (and perhaps others) barcode scanners in HID mode using WebHID. 

### What does this library do?

By default most barcode scanners emulate a keyboard meaning all numbers and letters of a barcode will be individually 'typed' by the barscanner. This means you either have to focus an input field before scanning, or you have to use global keyboard events and build some algorithm that can seperate out digits from barcodes from other digits that are being typed on the keyboard. 

This library uses WebHID to connect to the scanner and set the scanner in HID mode, which allows us to receive the barcodes in one event.

### How to use it?

Load the `webhid-barcode-scanner.umd.js` file in the browser and instantiate a `WebHIDBarcodeScanner` object. 

    <script src='webhid-barcode-scanner.umd.js></script>

    <script>

        const barcodeScanner = new WebHIDBarcodeScanner();

    </script>


Or import the `webhid-barcode-scanner.esm.js` module:

    import WebHIDBarcodeScanner from 'webhid-barcode-scanner.esm.js';

    const barcodeScanner = new WebHIDBarcodeScanner();



### Connect to a scanner

The first time you have to manually connect to the barcode scanner by calling the `connect()` function. This function must be called as the result of an user action, for example clicking a button. You cannot call this function on page load.

    function handleConnectButtonClick() {
        barcodeScanner.connect();
    }

Subsequent times you can simply call the `reconnect()` function. This will try to find any previously connected barcode scanners and will try to connect again. It is recommended to call this button on page load to prevent having to manually connect to a previously connected device.

    barcodeScanner.reconnect();

If there are no barcode scanners connected that have been previously connected, this function will do nothing.

However, this library will actively look for new devices being connected. So if you connect a previously connected barcode scanner, it will immediately become available.

To find out when a barcode scanner is connected you can listen for the `connected` event using the `addEventListener()` function.

    barcodeScanner.addEventListener('connected', device => {
        console.log(`Connected to ${device.productName}`);
    });

The callback of the `connected` event is passed an object with the following properties:

-   `vendorId`<br>
    In case of a USB HID barcode scanner, the USB vendor ID.
-   `productId`<br>
    In case of a USB HID barcode scanner, the USB product ID.
-   `productName`<br>
    The name of the barcode scanner.

To find out when a barcode scanner is disconnected you can listen for the `disconnected` event using the `addEventListener()` function.

    barcodeScanner.addEventListener('disconnected', () => {
        console.log(`Disconnected`);
    });


### Scanning barcodes

Whenever the libary detects a barcode, it will send out a `barcode` event that you can listen for.

barcodeScanner.addEventListener('barcode', e => {
    console.log(`Found barcode ${e.value} with symbology ${e.symbology}`);
});

The callback is passed an object with the following properties:

-   `value`<br>
    The value of the barcode as a string
-   `aim`<br>
    The AIM Code ID, which is a 3 character ISO/IEC identifier (originally created by AIM) generated by the decoder of a scanner and gives information about the symbology of the barcode which was scanned.
-   `symbology`<br>
    Optionally a library specific identifier of the symbology. 

### License

MIT
